!function(s){const e=s("div").data("wpspx-spektrix-base");if(console.log(e),"success"===sessionStorage.getItem("spektrix_auth")){let a=null,o={async:!0,crossDomain:!0,url:e+"customer",method:"GET",xhrFields:{withCredentials:!0},headers:{"Content-Type":"application/json","cache-control":"no-cache"},statusCode:{401:function(s){}},processData:!1};s.ajax(o).done((function(e){void 0!==e.id&&""!==e.id&&(a=e.id,s(".menu-item-wpspx-login").html('<div class="greeting">Hello '+e.firstName+'</div><a class="is-info" href="/my-account">">My Account</a><a class="logoutlink" onclick="wpspxLogout();">Log Out</a>'))})).fail((function(e,a,o){s(".menu-item-wpspx-login").html('<a class="loginlink" onclick="wpspxLogin()">Log in</a>')}))}wpspxLogout=()=>{const a={async:!0,crossDomain:!0,url:e+"customer/deauthenticate",method:"POST",xhrFields:{withCredentials:!0},headers:{"Content-Type":"application/json","cache-control":"no-cache"},processData:!1};s.ajax(a).done((function(s){location.reload()}))},wpspxLogin=()=>{s(".accountbox").addClass("is-active"),s(".delete").on("click",(function(){s(".accountbox").removeClass("is-active")}));let a='<p>Login to your account. Don\'t have one yet? You can <a class="registerlink" href="#">register here</a></p><div class="field"><div class="label"><label class="label">Email Address</label></div><div class="control"><input class="input" autocomplete="username" type="text" placeholder="Email" name="login-username" id="spektrix-username" required></div></div><div class="field"><div class="label"><label class="label">Password</label></div><div class="control"><input class="input" id="spektrix-password" autocomplete="current-password" type="password" placeholder="Password" name="login-password" required></div></div><div class="message-field"><div class="message" style="display:none;"><div class="message-body"></div></div></div></div>',o='<button id="loginbutton" class="button btn button-primary">Login<span class="loading"></span></button><button id="forgotpassword" class="button btn button-secondary">Forgot password?</button>';s(".modal-card-title").html("Login to your account"),s(".formcontent").html(a),s(".modal-card-foot").html(o),s("#loginbutton").on("click",(function(){s(this).children("span").addClass("show");const a={async:!0,crossDomain:!0,url:e+"customer/authenticate",method:"POST",xhrFields:{withCredentials:!0},headers:{"Content-Type":"application/json","cache-control":"no-cache"},processData:!1,data:'{\r\n  "email": "'+s("#spektrix-username").val()+'",\r\n  "password": "'+s("#spektrix-password").val()+'"\r\n}'};s.ajax(a).done((function(e){""!==e.id?(sessionStorage.setItem("spektrix_auth","success"),s(".message").addClass("is-success"),s(".message .message-body").text("Sucessfully loggin in..."),s(".message").show(),setTimeout((function(){s("#loginbutton span").removeClass("show"),s(".accountbox").removeClass("is-active")}),1e3),setTimeout((function(){location.reload()}),3e3)):(s(".message").addClass("is-danger"),s(".message .message-body").text("There was an error."),s(".message").show(),s("#loginbutton span").removeClass("show"))})).fail((function(e,a,o){switch(e.status){case 404:s(".message").addClass("is-danger"),s(".message .message-body").text("Invalid username or password"),setTimeout((function(){s(".message").show(),s("#loginbutton span").removeClass("show")}),1e3);break;case 401:s(".message").addClass("is-danger"),s(".message .message-body").text("There was an error trying to log you in."),setTimeout((function(){s(".message").show(),s("#loginbutton span").removeClass("show")}),1e3);break;default:s(".message").addClass("is-danger"),s(".message .message-body").text("There was an error trying to log you in."),setTimeout((function(){s("#loginbutton span").removeClass("show"),s(".message").show()}),1e3)}}))})),s("#forgotpassword").on("click",(function(t){s(".modal-card-title").html("Forgot your password"),s(".formcontent").html('<p>Please enter your email to reset your password.</p><div class="field"><div class="label"><label class="label">Email Address</label></div><div class="control"><input id="passwordresetemail" class="input" type="text" placeholder="your email" name="forgot-password" required></div></div><div class="message-field"><div class="message" style="display:none;"><div class="message-body"></div></div></div>'),s(".modal-card-foot").html('<button id="sendpassword" class="button btn button-primary">Reset Password<span class="loading"></span></button>'),s("#sendpassword").on("click",(function(a){s(this).children("span").addClass("show");var o=s("#passwordresetemail").val();if(""!==o){var t={async:!0,crossDomain:!0,url:e+"customer/forgot-password?emailAddress="+o,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","cache-control":"no-cache"}};s.ajax(t).done((function(e){s(".message").addClass("is-success"),s(".message .message-body").text("Password reset email sent."),setTimeout((function(){s(".message").show(),s("#sendpassword span").removeClass("show")}),1e3)})).fail((function(e,a,o){switch(e.status){case 404:s("#sendpassword span").removeClass("show"),s(".message").addClass("is-danger"),s(".message .message-body").text("No account found with this email address."),s(".message").show();break;default:s("#sendpassword span").removeClass("show"),s(".message").addClass("is-danger"),s(".message .message-body").text("Sorry there was an error - please call the box office to reset your password."),s(".message").show()}}))}else s("#sendpassword span").removeClass("show"),s(".message .message-body").text("You must enter an email address"),s(".message").show()})),s("#backtologin").on("click",(function(e){s(".modal-card-title").html("Login to your account"),s(".formcontent").html(a),s(".modal-card-foot").html(o)}))})),s(".registerlink").on("click",(function(a){s(".modal-card-title").html("Sign uo for an account"),s(".formcontent").html('<p>Please complete the below form to register for an account.</p><div class="field"><div class="label"><label class="label">Name</label></div><div class="control is-horizontal"><div class="field"><input class="input" type="text" placeholder="First Name" id="signup-firstname"></div><div class="field"><input class="input" type="text" placeholder="Last Name" id="signup-lastname"></div></div></div><div class="field"><label class="label">Date of Birth</label><div class="control"><input class="input" type="date" id="signup-birthdate"></div></div><div class="field"><label class="label">Phone Number</label><div class="control"><input class="input" type="text" id="signup-phone"></div></div><div class="field"><label class="label">Email Address</label><div class="control"><input class="input" type="email" id="signup-email"></div></div><div class="message-field"><div class="message" style="display:none;"><div class="message-body"></div></div></div></div>'),s(".modal-card-foot").html('<button id="register" class="button btn button-primary">Register<span class="loading"></span></button>'),s("#register").on("click",(function(a){s(this).children("span").addClass("show");var o={async:!0,crossDomain:!0,url:e+"customer",method:"POST",xhrFields:{withCredentials:!0},headers:{"Content-Type":"application/json","cache-control":"no-cache"},processData:!1,data:'{\r\n  "birthDate": "'+s("#signup-birthdate").val()+'",\r\n  "email": "'+s("#signup-email").val()+'",\r\n  "firstName": "'+s("#signup-firstname").val()+'",\r\n  "lastName": "'+s("#signup-lastname").val()+'",\r\n  "mobile": "'+s("#signup-phone").val()+'",\r\n  "password": "'+s("#signup-password").val()+'"\r\n}'};s.ajax(o).done((function(e){""!==e.id?(s(".message").addClass("is-success"),s(".message .message-body").text("Account sucessfully created, logging you in...."),s(".message").show(),s("#register span").removeClass("show"),setTimeout((function(){location.reload()}),3e3)):(s(".message").addClass("is-success"),s(".message .message-body").text("There was an error."),setTimeout((function(){s(".message").show(),s("#register span").removeClass("show")}),1e3))})).fail((function(e,a,o){e.status,s(".message").addClass("is-success"),s(".message .message-body").text("There was an error."),setTimeout((function(){s(".message").show(),s("#register span").removeClass("show")}),1e3)}))}))}))}}(jQuery);